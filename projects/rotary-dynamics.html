<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rotary Dynamics</title>
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <main class="main-wrapper">
        <div class="container">

            <h1>Helicopter Pitch Response: Closed-Loop Control & Dynamics Simulation</h1>
            <div class="fancy-line"></div>

            <p><a href="/index.html">← Back to Home</a></p>
            <section>
                <h2>Executive Summary</h2>
                <p>
                  Modeled a second-order pitch dynamic system for an AH-1 Cobra using Simulink. Designed and tested PID controllers to stabilize pitch axis rotation under command inputs and simulated wind disturbance. Compared multiple control configurations and visualized their stability, transient behavior, and steady-state error. Demonstrated the importance of proportional, integral, and derivative contributions.
                </p>
              
                <h2>Introduction</h2>
                <p>
                  Net Torque (&sum;&tau;), which is derived from Newton’s Second Law for rotational systems, is defined by the product of angular acceleration (&theta;&Prime;&Prime;) and a rigid body’s moment of inertia (I):
                </p>
                <div class="equation">&theta;&Prime;&Prime; = &sum;&tau; / I</div>
                <div class="equation">&sum;&tau; = &theta;&Prime;&Prime; &times; I</div>
              
                <p>
                  The net torque (&sum;&tau;) is composed of an input torque (M), counteracted by damping torque (D&theta;&Prime;) and stiffness torque (K&theta;):
                </p>
                <div class="equation">&sum;&tau; = M − D&theta;&Prime; − K&theta;</div>
              
                <p>
                  Inserting the net torque into the equation for angular acceleration gives:
                </p>
                <div class="equation">&theta;&Prime;&Prime; = (M − D&theta;&Prime; − K&theta;) / I</div>
                
                
                <h3>Deriving System Parameters</h3>
                <p>
                  With angular acceleration (&theta;&Prime;&Prime;) fully defined in terms of torque, damping, stiffness, and inertia, the system’s response can be characterized under varying control inputs and disturbances. These terms are defined below so they can be calculated using known values. 
                </p>
                <h4>
                    Inertia (I)
                </h4>
                <p>
                  The Parallel Axis Theorem can be used to determine the moment of inertia (I) of a rigid body about any axis, given its moment of inertia about a parallel axis through its center of mass (I<sub>com</sub>). The relationship is defined by:
                </p>
                <div class="equation">I = I<sub>com</sub> + m &middot; h<sup>2</sup></div>
              
                <p>
                  I<sub>com</sub> is the moment of inertia of the helicopter’s fuselage about its own center of mass (CG), assuming it's a rigid body. Since we’re approximating the AH-1 Cobra fuselage as a uniform rectangular solid, we can use the classic formula:
                </p>
                <div class="equation">I<sub>com</sub> = (1/12) &middot; m &middot; (w<sup>2</sup> + h<sup>2</sup>)</div>
              
                <p>
                  Below, Figure 1 is used from <em>The Illustrated Encyclopedia of the World’s Modern Military Aircraft</em> as a starting point to determine and solve for many of the variables needed.
                </p>
                <img src="/Images/schematic.png" alt="AH-1 Cobra Schematic" width="600">

                <p>AH-1 Cobra Key Specifications</p>
                    <ul>
                    <li><strong>Crew:</strong> 2 (Pilot and Co-pilot/Gunner)</li>
                    <li><strong>Fuselage Length:</strong> 13.5 m</li>
                    <li><strong>Width:</strong> 3.15 m</li>
                    <li><strong>Max Takeoff Weight (MTOW):</strong> 4,309 kg</li>
                    <li><strong>Typical Armament:</strong> Miniguns, grenade launchers, 70mm rockets, and 20mm cannon</li>
                    </ul>

              </section>
              <section>
                <p>
                  The height and width are given, the only quantity remaining is mass. The table below outlines a representative full combat load configuration for the AH-1 Cobra, operating near its maximum takeoff weight (MTOW) of 4,309 kg. This estimate includes a complete fuel load, pilot and gunner, and a full armament suite typical of heavy combat missions. While actual configurations may vary depending on mission profile and environmental conditions, this breakdown provides a realistic upper limit for operational weight planning.
                </p>
              
                <table>
                    <thead>
                      <tr><th>Component</th><th>Estimated Weight (kg)</th></tr>
                    </thead>
                    <tbody>
                      <tr><td>Empty Weight</td><td>2635</td></tr>
                      <tr><td>Fuel (JP-4, ~375 gal)</td><td>635</td></tr>
                      <tr><td>Pilot + Gunner</td><td>180</td></tr>
                      <tr><td>Armament Loadout (Minigun, Grenade Launcher, Rocket Pods, 20mm Cannon)</td><td>925</td></tr>
                      <tr><td>XM35 20 mm Cannon Subsystem (w/ ammo)</td><td>320</td></tr>
                      <tr><td><strong>Total Estimated Weight</strong></td><td><strong>4375</strong></td></tr>
                      <tr><td><em>Max Takeoff Weight (MTOW)</em></td><td><em>4309</em></td></tr>
                    </tbody>
                  </table>
                  
              <p>
                With the known variables, the center of mass inertia can now be calculated:
              </p>
                <div class="equation">
                  I<sub>com</sub> = (1/12) &middot; 4309 &middot; (3.15<sup>2</sup> + 4.11<sup>2</sup>) = 9628 kg&middot;m<sup>2</sup>
                </div>
              
                <p>
                  To apply the Parallel Axis Theorem and estimate the helicopter's total moment of inertia, we must define the offset distance <em>h</em> — the distance between the helicopter’s CG and the axis of rotation. In this case, the axis of rotation is the pitch axis through the main rotor mast.
                </p>
                <p>
                  As an exact center of gravity or mast schematic for the AH-1 Cobra is not publicly available, <em>h</em> is approximated based on fuselage length proportions. We assume the rotor mast sits at 55% of the fuselage length (measured from the tail), and the center of gravity at 45%. This yields:
                </p>
              
                <div class="equation">
                  h = |0.55 − 0.45| &times; 13.5 m ≈ 1.35 m
                </div>
              
                <p>With the parameters known, the total inertia can be estimated:</p>
             
                <div class="equation">
                  I = I<sub>com</sub> + m &middot; h<sup>2</sup><br>
                  I = 6707 + 3003 &times; (1.35)<sup>2</sup> = 12,182 kg&middot;m<sup>2</sup>
                </div>
              
                <p>
                  This value represents the total moment of inertia about the pitch axis, accounting for both the distribution of fuselage mass relative to the rotor axis and the offset of the rotational axis from the center of mass. It combines the intrinsic resistance to rotation (about the CG) with the additional inertia introduced by the spatial separation between the rotor mast and the helicopter’s center of gravity.
                </p>
              
                <section>
  <h4>Stiffness and Damping</h4>
  <p>
    Returning to the governing equation of the plant model, expressions defining the damping coefficient (<strong>D</strong>) and the stiffness coefficient (<strong>K</strong>) can be derived as follows:
  </p>
  <pre><code>I * θ'' + D * θ' + K * θ = M(t)</code></pre>
  <p>This equation represents the sum of torques acting on a rigid body: inertial, damping, and stiffness torques. Dividing both sides by the moment of inertia (I):</p>
  <pre><code>θ'' + (D/I) * θ' + (K/I) * θ = M(t)/I</code></pre>
  <p>This yields a canonical second-order system equation:</p>
  <pre><code>θ'' + 2 * ζ * ω<sub>n</sub> * θ' + ω<sub>n</sub><sup>2</sup> * θ = M(t)/I</code></pre>
  <p>By comparing coefficients, we get:</p>
  <ul>
    <li><code>D = 2 * ζ * ω<sub>n</sub> * I</code></li>
    <li><code>K = ω<sub>n</sub><sup>2</sup> * I</code></li>
  </ul>

  <ul>
    <li><strong>Damping ratio (ζ)</strong> = 0.7
      <ul>
        <li>A balance between responsiveness and stability</li>
        <li>Suppresses oscillations (ζ &lt; 0.5)</li>
        <li>Avoids sluggishness (ζ &gt; 1)</li>
        <li>ζ = 0.707 provides critical damping with no overshoot</li>
      </ul>
    </li>
    <li><strong>Natural frequency (ω<sub>n</sub>)</strong> = 2 rad/s — based on NASA TP-2184 and other rotary-wing dynamics references</li>
  </ul>

  <p>Using these, we calculate:</p>
  <ul>
    <li><strong>D</strong> = 2 × 0.7 × 2 × 12,182 ≈ <strong>34,110 N·m·s/rad</strong></li>
    <li><strong>K</strong> = 4 × 12,182 ≈ <strong>48,728 N·m/rad</strong></li>
  </ul>
</section>
<section>
  <h4>Disturbance Input (Upward Gust)</h4>
  <p>
    The helicopter experiences a 25 m/s upward gust acting 1.219 m forward of the center of gravity for 5 seconds. The resulting torque generated from this force is solved using the Dynamic Pressure Equation:
  </p>
  <pre><code>F = ½ × ρ × V² × A × C<sub>D</sub></code></pre>
  <ul>
    <li>ρ ≈ 1.225 kg/m³</li>
    <li>V = 25 m/s</li>
    <li>A = 2.5 m²</li>
    <li>C<sub>D</sub> = 1.2</li>
    <li>F ≈ 459.4 N</li>
    <li>Torque τ = 459.4 × 1.219 ≈ <strong>560.2 N·m</strong></li>
  </ul>
 <section>
  <p>
    This type of disturbance could plausibly occur during low-altitude combat maneuvers, such as <em>nap-of-the-earth</em> flight or quick terrain masking, where rotorcraft often encounter strong localized updrafts near cliffs, urban heat plumes, or rotor wash interactions with structures and terrain. Modeling this event allows us to assess the system’s ability to reject sudden, asymmetric vertical forces that could destabilize the pitch axis mid-flight.
  </p>

  <p>
    The calculated parameters represent the primary physical contributors to the system's rotational behavior — corresponding to applied torque, damping, stiffness, and disturbance torque. With <code>M</code> generated by the PID controller and <code>D</code>, <code>K</code>, and disturbance now estimated from physical assumptions, all variables have been accounted for.
  </p>

  <p>
    However, the specific values for these variables must still be implemented within the modeling environment. These include setting block parameters such as gain values, input magnitudes, and initial conditions. Once configured, the model can simulate realistic angular acceleration in response to both pilot control inputs and external disturbances.
  </p>
</section>







    
</section>

<section>
<section>
  <h2>MATLAB Simulink Model</h2>

  <p>
    The software used to simulate and model the helicopter’s dynamic response is MATLAB Simulink, a platform designed for time-domain modeling of control systems using visual block diagrams. It enables modular construction, intuitive parameter tuning, and seamless signal logging for analysis in MATLAB.
  </p>

  <p>
    The Simulink model captures the closed-loop pitch dynamics of the AH-1 Cobra. Starting from a user-defined pitch command, the system processes control inputs through a PID controller, introduces environmental disturbances, and models the resulting angular acceleration using a physics-based second-order system. The angular output is then integrated twice to simulate pitch rate and position. This allows evaluation of how the helicopter responds to both intentional control inputs and unexpected external forces.
  </p>

  <p>
    The structure of the model and the flow of signals through the control loop are shown in Figure 2, below.
  </p>

<img src="/Images/diagram.png" alt="Simulink Model: PID Pitch Control" style="max-width: 100%; height: auto;" />

  <p>The system’s main signal flow can be summarized as follows:</p>

  <ul>
    <li><strong>Step Input Block</strong>
      <ul>
        <li>Step time: 1 second</li>
        <li>Initial value: 0°</li>
        <li>Final value: 10° (or 0.1745 radians used in the step block)</li>
      </ul>
    </li>

    <li><strong>PID Controller Block</strong>
      <ul>
        <li>Proportional gain (P): varies by test case</li>
        <li>Integral gain (I): varies by test case</li>
        <li>Derivative gain (D): varies by test case</li>
        <li>Filter coefficient: Tuned for smoothing if needed</li>
      </ul>
    </li>

    <li><strong>Gain Block (1/I)</strong>
      <ul>
        <li>Calculated moment of inertia: I = 12,182 kg·m²</li>
        <li>Gain value: 1 / 12,182 ≈ 8.21 × 10⁻⁵ (1 / N·m·s²)</li>
      </ul>
    </li>

    <li><strong>Damping Gain Block (D)</strong>
      <ul>
        <li>Gain: 510,507 N·m·s/rad</li>
      </ul>
    </li>

    <li><strong>Stiffness Gain Block (K)</strong>
      <ul>
        <li>Gain: 729,296 N·m/rad</li>
      </ul>
    </li>

    <li><strong>Integrator Blocks (2 total)</strong>
      <ul>
        <li>Initial condition: 0 (for both angular velocity and angular displacement)</li>
      </ul>
    </li>

    <li><strong>To Workspace Blocks</strong>
      <ul>
        <li>Save format: Array</li>
        <li>Variable names: e.g., <code>theta</code>, <code>theta_dot</code>, <code>control_signal</code></li>
        <li>Limit data points: Unchecked (records entire sim duration)</li>
      </ul>
    </li>

    <li><strong>Disturbance Torque (Pulse Generator and Gain)</strong>
      <ul>
        <li>Amplitude: 560.2 N·m</li>
        <li>Period: 30 seconds</li>
        <li>Pulse width: 16.6% (5 seconds)</li>
        <li>Phase delay: 1 second</li>
      </ul>
    </li>
  </ul>

  <p>
    These parameter values represent estimated physical properties and control assumptions based on AH-1 Cobra dynamics and control theory.
  </p>

  <p>
    With all variables and parameters defined, simulation can begin.
  </p>
</section>

</section>

        <h2>Test Description</h2>
        <ul>
            <li><strong>Simulated Configuration:</strong> Second-order pitch system in Simulink, controlled by PID loop
                with optional disturbance torque input</li>
            <li><strong>Inputs:</strong> Step command (0° to 10°), and sinusoidal wind disturbance</li>
            <li><strong>Outputs:</strong> Pitch angle (θ) over time</li>
            <li><strong>Test Matrix:</strong> Three PID configurations:
                <ul>
                    <li><strong>Set A:</strong> Balanced tuning (P = 2, I = 0.2, D = 0.4)</li>
                    <li><strong>Set B:</strong> Aggressive tuning (P = 3, I = 0.8, D = 0.5)</li>
                    <li><strong>Set C:</strong> No integral (P = 1, I = 0, D = 0)</li>
                </ul>
            </li>
            <li><strong>Data Logging:</strong> Simulink time series outputs visualized in MATLAB</li>
        </ul>

        <h2>Results & Analysis</h2>
        <ul>
            <li><strong>Set A (P = 2, I = 0.2, D = 0.4):</strong> Settled within ±1° by ~25 seconds; showed balanced
                response with minimal overshoot.</li>
            <li><strong>Set B (P = 3, I = 0.8, D = 0.5):</strong> Faster rise time with some overshoot; still achieved
                steady-state within target window.</li>
            <li><strong>Set C (P = 1, I = 0, D = 0):</strong> Persistent steady-state error (~20°); no integral action
                meant disturbance was not rejected.</li>
        </ul>
        <p>
            A MATLAB overlay compared all three controller responses. The system’s transient and steady-state behaviors
            were visualized and confirmed expected theoretical effects of PID term adjustments.
        </p>

        <h2>Discussion</h2>
        <ul>
            <li>Proportional gain improves responsiveness but can induce overshoot.</li>
            <li>Integral gain is essential to eliminate bias under constant torque disturbance.</li>
            <li>Derivative gain stabilizes transient behavior and reduces oscillations.</li>
            <li>The observed results matched classic PID controller theory and demonstrated direct control over pitch
                dynamics.</li>
        </ul>

        <h2>Conclusions</h2>
        <ul>
            <li>All test objectives were met: the pitch system was modeled, stabilized, and characterized across
                multiple configurations.</li>
            <li>Simulink and MATLAB provided effective tools for rapid prototyping, testing, and visualization.</li>
            <li>This project serves as a foundation for future work in multi-axis control or model-based design
                validation.</li>
        </ul>

        <h2>Appendices</h2>
        <ul>
            <li>Simulink block diagram (architecture screenshot)</li>
            <li>MATLAB script for PID overlay plot</li>
            <li>Expanded response plots with labeled conditions</li>
            <li>Glossary: PID terms, plant equation, disturbance explanation</li>
        </ul>

        <h2>References</h2>
        <ul>
            <li><em>Control Systems Engineering</em> – Nise</li>
            <li>MathWorks Simulink & PID Controller Documentation</li>
            <li>Personal tuning logs and Simulink simulation outputs</li>
        </ul>

        </div> <!-- closes .container -->
    </main>
</body>

</html>

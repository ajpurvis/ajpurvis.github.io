<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rotary Dynamics</title>
    <link rel="stylesheet" href="/style.css" />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>

<body>
    <main class="main-wrapper">
        <div class="container">
<div style="font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: auto; padding: 20px;">
            <h1>Helicopter Pitch Response: Closed-Loop Control & Dynamics Simulation</h1>
            <div class="fancy-line"></div>

            <p><a href="/index.html">← Back to Home</a></p>
            <section>
                <h2>Executive Summary</h2>
                <p>
                  Modeled a second-order pitch dynamic system for an AH-1 Cobra using Simulink. Designed and tested PID controllers to stabilize pitch axis rotation under command inputs and simulated wind disturbance. Compared multiple control configurations and visualized their stability, transient behavior, and steady-state error. Demonstrated the importance of proportional, integral, and derivative contributions.
                </p>
              
                <h2>Introduction</h2>
                <p>
                  Net Torque (\(\sum \tau\)), which is derived from Newton’s Second Law for rotational systems, is defined by the product of angular acceleration (&theta;&Prime;&Prime;) and a rigid body’s moment of inertia (I):
                </p>
                
$$
 {\sum \tau} = \ddot{\theta}{I}
$$
<p>
 Using this, angular acceleration can be isolated.
</p>

$$
\ddot{\theta} = \frac{\sum \tau}{I}
$$


<p>
    To solve for angular acceleration, torque and moment of inertia must be expressed in terms of measurable or estimated variables.
    The net torque (\(\sum \tau\)) can be defined as an input torque (M), counteracted by damping torque (D) and stiffness torque (K):
</p>

$$
\sum \tau = M - D\dot{\theta} - K\theta
$$
                
<p>
  Using the Parallel Axis Theorem, the moment of inertia can be expanded into a form that accounts for mass distribution relative to the rotation axis, yielding a solvable expression in terms of known geometry and mass.
</p>
$$
I = I_{\text{com}} + m \cdot h^2 
$$
<p>
  Inserting the new expressions net torque and inertia into the equation for angular acceleration gives:
</p>

$$
\ddot{\theta} = \frac{M - D\dot{\theta} - K\theta}{I_{\text{com}} + m \cdot h^2}
$$

                
                
                <h3>Deriving System Parameters</h3>
                <p>
                  With angular acceleration (\ddot{\theta}) fully defined in terms of torque, damping, stiffness, and inertia, the system’s response can be characterized under varying control inputs and disturbances. These terms are defined below so they can be calculated using known values. 
                </p>
                <h4>
                    Inertia (I)
                </h4>

  <p>
    The Parallel Axis Theorem can be used to determine the moment of inertia (<i>I</i>) of a rigid body about any axis, given its moment of inertia about a parallel axis through its center of mass (\(I_{\text{com}}\)). The relationship is defined by:
  </p>

  <div style="text-align: center; margin: 1rem 0;">
    \[
    I = I_{\text{com}} + m \cdot h^2
    \]
  </div>

  <p>
    \(I_{\text{com}}\) is the moment of inertia of the helicopter’s fuselage about its own center of mass (CG), assuming it is a rigid body. Since we’re approximating the AH-1 Cobra fuselage as a uniform rectangular solid, we can use the classic formula:
  </p>

  <div style="text-align: center; margin: 1rem 0;">
    \[
    I_{\text{com}} = \frac{1}{12} \cdot m \cdot (w^2 + h^2)
    \]
  </div>
              
                <p>
                  Below, Figure 1 is used from <em>The Illustrated Encyclopedia of the World’s Modern Military Aircraft</em> as a starting point to determine and solve for many of the variables needed.
                </p>

                <p>AH-1 Cobra Key Specifications</p>
                    <ul>
                    <li><strong>Crew:</strong> 2 (Pilot and Co-pilot/Gunner)</li>
                    <li><strong>Fuselage Length:</strong> 13.5 m</li>
                    <li><strong>Height:</strong> 4.11 m</li>
                    <li><strong>Width:</strong> 3.15 m</li>
                    <li><strong>Max Takeoff Weight (MTOW):</strong> 4,309 kg</li>
                    <li><strong>Typical Armament:</strong> Miniguns, grenade launchers, 70mm rockets, and 20mm cannon</li>
                    </ul>
                <p>
                  The height and width are given, the only quantity remaining is mass. The table below outlines a representative full combat load configuration for the AH-1 Cobra, operating near its maximum takeoff weight (MTOW) of 4,309 kg. This estimate includes a complete fuel load, pilot and gunner, and a full armament suite typical of heavy combat missions. While actual configurations may vary depending on mission profile and environmental conditions, this breakdown provides a realistic upper limit for operational weight planning.
                </p>

              <p>
                With the unknowns estimated, the center of mass inertia can now be calculated:
              </p>


  <div style="text-align: center; margin: 1rem 0;">
    \[
    I_{\text{com}} = \frac{1}{12} \cdot 4309 \cdot (3.15^2 + 4.11^2) = 9,628 \ \text{kg} \cdot \text{m}^2
    \]
  </div>

  <p>
    To apply the Parallel Axis Theorem and estimate the helicopter's total moment of inertia, we must define the offset distance \( h \) — the distance between the helicopter’s CG and the axis of rotation. In this case, the axis of rotation is the pitch axis through the main rotor mast.
  </p>

  <p>
    As an exact center of gravity or mast schematic for the AH-1 Cobra is not publicly available, \( h \) is approximated based on fuselage length proportions. We assume the rotor mast sits at 55% of the fuselage length (measured from the tail), and the center of gravity at 45%. This yields:
  </p>

  <div style="text-align: center; margin: 1rem 0;">
    \[
    h = \left| 0.55 - 0.45 \right| \times 13.5 \ \text{m} \approx 1.35 \ \text{m}
    \]
  </div>

  <p>With the parameters known, the total inertia can be estimated:</p>
             
<div style="text-align: center; margin: 1rem 0;">
  \[
  I = I_{\text{com}} + m \cdot h^2
  \]
  \[
  I = 9628 + 3003 \cdot (1.35)^2 = 15{,}100 \ \text{kg} \cdot \text{m}^2
  \]
</div>
              
                <p>
                  This value represents the total moment of inertia about the pitch axis, accounting for both the distribution of fuselage mass relative to the rotor axis and the offset of the rotational axis from the center of mass. It combines the intrinsic resistance to rotation (about the CG) with the additional inertia introduced by the spatial separation between the rotor mast and the helicopter’s center of gravity.
                </p>
              
                <section>
  <h4>Stiffness and Damping</h4>
  <p>
    Returning to the governing equation of the plant model, expressions defining the damping coefficient (<strong>D</strong>) and the stiffness coefficient (<strong>K</strong>) can be derived as follows:
  </p>
<div style="text-align: center; margin: 1rem 0;">
  \[
  I \cdot \ddot{\theta} + D \cdot \dot{\theta} + K \cdot \theta = M(t)
  \]
</div>
<p>
  This equation represents the sum of torques acting on a rigid body: inertial, damping, and stiffness torques. Dividing both sides by the moment of inertia (\( I \)):
</p>

<div style="text-align: center; margin: 1rem 0;">
  \[
  I \cdot \ddot{\theta} + D \cdot \dot{\theta} + K \cdot \theta = M(t)
  \]
  \[
  \ddot{\theta} + \frac{D}{I} \cdot \dot{\theta} + \frac{K}{I} \cdot \theta = \frac{M(t)}{I}
  \]
</div>

<p>
  This yields a canonical second-order system equation:
</p>

<div style="text-align: center; margin: 1rem 0;">
  \[
  \ddot{\theta} + 2 \zeta \omega_n \cdot \dot{\theta} + \omega_n^2 \cdot \theta = \frac{M(t)}{I}
  \]
</div>

<p>By comparing coefficients, we get:</p>

<ul>
  <li>\( D = 2 \zeta \omega_n I \)</li>
  <li>\( K = \omega_n^2 I \)</li>
</ul>

  <ul>
    <li><strong>Damping ratio (ζ)</strong> = 0.7
      <ul>
        <li>A balance between responsiveness and stability</li>
        <li>Suppresses oscillations (ζ &lt; 0.5)</li>
        <li>Avoids sluggishness (ζ &gt; 1)</li>
        <li>ζ = 0.707 provides critical damping with no overshoot</li>
      </ul>
    </li>
    <li><strong>Natural frequency (ω<sub>n</sub>)</strong> = 2 rad/s — based on NASA TP-2184 and other rotary-wing dynamics references</li>
  </ul>

  <p>Using these, we calculate:</p>
  <ul>
    <li><strong>D</strong> = 2 × 0.7 × 2 × 12,182 ≈ <strong>34,110 N·m·s/rad</strong></li>
    <li><strong>K</strong> = 4 × 12,182 ≈ <strong>48,728 N·m/rad</strong></li>
  </ul>
</section>
<section>
  <h4>Disturbance Input (Upward Gust)</h4>
  <p>
    The helicopter experiences a 25 m/s upward gust acting 1.219 m forward of the center of gravity for 5 seconds. The resulting torque generated from this force is solved using the Dynamic Pressure Equation:
  </p>
<div style="text-align:center; margin:1rem 0;">
  \[
    F \;=\; \tfrac{1}{2}\,\rho\,V^{2}\,A\,C_D
  \]
</div>
  <ul>
    <li>ρ ≈ 1.225 kg/m³</li>
    <li>V = 25 m/s</li>
    <li>A = 2.5 m²</li>
    <li>C<sub>D</sub> = 1.2</li>
    <li>F ≈ 459.4 N</li>
    <li>Torque = 459.4 × 1.219 ≈ <strong>560.2 N·m</strong></li>
  </ul>
 <section>
  <p>
    This type of disturbance could plausibly occur during low-altitude combat maneuvers, such as <em>nap-of-the-earth</em> flight or quick terrain masking, where rotorcraft often encounter strong localized updrafts near cliffs, urban heat plumes, or rotor wash interactions with structures and terrain. Modeling this event allows us to assess the system’s ability to reject sudden, asymmetric vertical forces that could destabilize the pitch axis mid-flight.
  </p>

  <p>
    The calculated parameters represent the primary physical contributors to the system's rotational behavior — corresponding to applied torque, damping, stiffness, and disturbance torque. With <code>M</code> generated by the PID controller and <code>D</code>, <code>K</code>, and disturbance now estimated from physical assumptions, all variables have been accounted for.
  </p>

  <p>
    However, the specific values for these variables must still be implemented within the modeling environment. These include setting block parameters such as gain values, input magnitudes, and initial conditions. Once configured, the model can simulate realistic angular acceleration in response to both pilot control inputs and external disturbances.
  </p>
</section>








    

    
</section>

<section>
<section>
  <h2>MATLAB Simulink Model</h2>

  <p>
    The software used to simulate and model the helicopter’s dynamic response is MATLAB Simulink, a platform designed for time-domain modeling of control systems using visual block diagrams. It enables modular construction, intuitive parameter tuning, and seamless signal logging for analysis in MATLAB.
  </p>

  <p>
    The Simulink model captures the closed-loop pitch dynamics of the AH-1 Cobra. Starting from a user-defined pitch command, the system processes control inputs through a PID controller, introduces environmental disturbances, and models the resulting angular acceleration using a physics-based second-order system. The angular output is then integrated twice to simulate pitch rate and position. This allows evaluation of how the helicopter responds to both intentional control inputs and unexpected external forces.
  </p>

  <p>
    The structure of the model and the flow of signals through the control loop are shown in Figure 2, below.
  </p>

    <div style="text-align: center; margin: 2rem 0;">
  <figure style="display: inline-block;">
    <img src="/Images/diagram2.png" alt="Simulink Model of PID Pitch Stabilization" style="max-width: 100%; height: auto; border: 1px solid #ccc; padding: 4px;">
    <figcaption style="margin-top: 0.5rem;"><strong>Figure 2:</strong> Simulink model of PID-controlled pitch response under control and disturbance inputs.</figcaption>
  </figure>
</div>

  <p>The system’s main signal flow can be summarized as follows:</p>

  <ul>
    <li><strong>Step Input Block</strong>
      <ul>
        <li>Step time: 1 second</li>
        <li>Initial value: 0°</li>
        <li>Final value: 10° (or 0.1745 radians used in the step block)</li>
      </ul>
    </li>

    <li><strong>PID Controller Block</strong>
      <ul>
        <li>Proportional gain (P): varies by test case</li>
        <li>Integral gain (I): varies by test case</li>
        <li>Derivative gain (D): varies by test case</li>
        <li>Filter coefficient: Tuned for smoothing if needed</li>
      </ul>
    </li>

    <li><strong>Gain Block (1/I)</strong>
      <ul>
        <li>Calculated moment of inertia: I = 12,182 kg·m²</li>
        <li>Gain value: 1 / 12,182 ≈ 8.21 × 10⁻⁵ (1 / N·m·s²)</li>
      </ul>
    </li>

    <li><strong>Damping Gain Block (D)</strong>
      <ul>
        <li>Gain: 510,507 N·m·s/rad</li>
      </ul>
    </li>

    <li><strong>Stiffness Gain Block (K)</strong>
      <ul>
        <li>Gain: 729,296 N·m/rad</li>
      </ul>
    </li>

    <li><strong>Integrator Blocks (2 total)</strong>
      <ul>
        <li>Initial condition: 0 (for both angular velocity and angular displacement)</li>
      </ul>
    </li>

    <li><strong>To Workspace Blocks</strong>
      <ul>
        <li>Save format: Array</li>
        <li>Variable names: e.g., <code>theta</code>, <code>theta_dot</code>, <code>control_signal</code></li>
        <li>Limit data points: Unchecked (records entire sim duration)</li>
      </ul>
    </li>

    <li><strong>Disturbance Torque (Pulse Generator and Gain)</strong>
      <ul>
        <li>Amplitude: 560.2 N·m</li>
        <li>Period: 30 seconds</li>
        <li>Pulse width: 16.6% (5 seconds)</li>
        <li>Phase delay: 1 second</li>
      </ul>
    </li>
  </ul>

  <p>
    These parameter values represent estimated physical properties and control assumptions based on AH-1 Cobra dynamics and control theory.
  </p>

  <p>
    With all variables and parameters defined, simulation can begin.
  </p>
</section>

</section>

<hr style="border: none; height: 2px; background-color: red; margin: 2rem 0;" />
<p style="text-align: center; font-weight: bold;">Work in Progress Below</p>
<hr style="border: none; height: 2px; background-color: red; margin: 2rem 0;" />

    <!-- ───────────  REMAINING SECTIONS ROADMAP  ─────────── -->
<h3 id="roadmap">Roadmap to Conclusion</h3>

<table style="font-family:Arial,sans-serif;border-collapse:collapse;max-width:720px;margin:auto;font-size:0.95rem;">
  <thead style="background:#1e3a5f;color:#fff;">
    <tr>
      <th style="padding:0.5rem 0.75rem;text-align:left;">Section</th>
      <th style="padding:0.5rem 0.75rem;text-align:left;">Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Flight-Test Strategy</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Outline test objectives, manoeuvre sequence, and safety limits that will validate the simulation results on the aircraft.
      </td>
    </tr>

    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Instrumentation &amp; Data Capture</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Describe the sensors, data-rates, and logging hardware required to measure pitch response in flight.
      </td>
    </tr>

    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Model Validation &amp; System ID</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Compare flight-test data with simulated response and refine model parameters using system-identification techniques.
      </td>
    </tr>

    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Results Analysis</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Interpret time-domain and frequency-domain metrics, highlight discrepancies, and discuss control-margin implications.
      </td>
    </tr>

    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Conclusions &amp; Recommendations</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Summarise findings, state limitations, and recommend next steps for full-envelope testing or design updates.
      </td>
    </tr>

    <tr>
      <td style="border:1px solid #444;padding:0.5rem;">Final Publication</td>
      <td style="border:1px solid #444;padding:0.5rem;">
        Package the report, web page, and presentation materials for external review and professional outreach.
      </td>
    </tr>
  </tbody>
</table>

</html>
